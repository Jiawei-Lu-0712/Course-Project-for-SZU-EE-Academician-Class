# 小麻雀SoC手册

## 简介
小麻雀SoC是基于小麻雀内核开发的微控制器级SoC设计，搭载了常见数字外设和功能模块，满足基本的控制需求。  

## 整体架构
### 总线架构
### 存储器映像
小麻雀SoC包含了程序存储器、数据存储器、外设寄存器等，他们都被编址在一个4GB线性地址空间。地址空间以小端形式组织，低地址低字节，高地址高字节。

总线桥：

|起始地址|结束地址|功能|
|-|-|-|
|0x0000_0000|0x1FFF_FFFF|s0 程序存储器iram|
|0x2000_0000|0x3FFF_FFFF|s1 数据存储器sram|
|0x4000_0000|0x3FFF_FFFF|s2 系统外设|
|0x6000_0000|0x3FFF_FFFF|s3 PLIC|
|0x8000_0000|0x3FFF_FFFF|s4 SD读卡器外设|
|0xa000_0000|0x3FFF_FFFF|s5 保留|
|0xc000_0000|0x3FFF_FFFF|s6 保留|
|0xe000_0000|0xFFFF_FFFF|s7 保留|

程序存储器iram，数据存储器sram实际大小在config.v可配置

## 外设
### FPIOA
小麻雀处理器的FPIOA功能与K210极为相似，它没有传统意义上的外设专用引脚。  
FPIOA是对外可见的IO端口，通常直接连接到FPGA的IO引脚。它不像一般的单片机，指定了某个引脚对应了哪几种功能，而是能将任意外设功能端口映射到任意的FPIOA端口。  

举个例子：  
对于典中典8051，串口0对应了P3.0 P3.1这两个IO口；如果我想用串口0，则必须把外围电路的Rx Tx连到P3.0 P3.1。  
对于小麻雀处理器，则没有这种限制。默认有16个FPIOA端口，可以直接拉到FPGA的IO引脚。然后串口0的Tx发送功能，可以映射到FPIOA\[15:0\]中的任意一个，而不是只能使用固定的端口。  

同时，FPIOA与NIO(Noraml I/O)相结合，满足一般的软件输入输出需求。就像单片机的GPIO一样，可以根据需求配置为推挽输出、开漏输出、高阻输入模式，既可以输出高低电平信号，也可以作为输入读取电平值。NIO与FPIOA编号是一一对应的。

